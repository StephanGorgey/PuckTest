<html>
<head>

<button type="button" id="myPuck_connect" > Connect Puck via Bluetooth </button>
<button type="button" id="Step_Counter" > Steps </button>
  
<script src="https://www.puck-js.com/puck.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>      
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dygraph/2.1.0/dygraph.js"></script>
</head>
  
<body>
<script type="text/javascript">
$(document).ready(function () {
      var rec_flag = false;
      var start_time;
      var connection;
      var xconnect = document.getElementById("myPuck_connect");
      var step_count= document.getElementById("Step_Counter");
  
  function StepCounter()
      {            
        step_count.splice(0,data.length);
        connection.write("setInterval(function(){Bluetooth.println(step().toFixed(3));} ,30); \n", function() { });
                        };     
      }
   
  
      function bluetooth_connect() {
            Puck.connect(function(c) {
              //      alert("In Puck connect");
                      if (!c) {
                      alert("Try Again!");
                          return;
                        }
                        connection = c;               
                  // Handle the data we get back, and call 'onLine'
                  // whenever we get a line
                        var buf = "";
                        connection.on("data", function(d) {
                         buf += d;
                        var i = buf.indexOf("\n");
                        while (i>=0) {
                              onLine(buf.substr(0,i));
                              buf = buf.substr(i+1);
                              i = buf.indexOf("\n");
                            }
                        }); // connection.on ()
                        xconnect.textContent = "Disconnect Puck via Bluetooth";
            }); // End Puck.connect () 
}   
     

      xconnect.addEventListener("click", function () { bluetooth_connect() } );
    }); 
  
  
</script>
</body>
</html>
