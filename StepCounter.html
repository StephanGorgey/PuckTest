<html>
<head>

<button type="button" id="myPuck_connect" > Connect Puck via Bluetooth </button>

<script src="https://www.puck-js.com/puck.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>      
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dygraph/2.1.0/dygraph.js"></script>
</head>
  
<body>
<div id="div_g" style="width:1200px; height:600px;"></div>
<script type="text/javascript">
$(document).ready(function () {
      var data = [];
      var rec_flag = false;
      var start_time;
      var connection;
      var xconnect = document.getElementById("myPuck_connect");
   
      function bluetooth_connect() {
            Puck.connect(function(c) {
              //      alert("In Puck connect");
                      if (!c) {
                      alert("Couldn't connect!");
                          return;
                        }
                        connection = c;               
                  // Handle the data we get back, and call 'onLine'
                  // whenever we get a line
                        var buf = "";
                        connection.on("data", function(d) {
                         buf += d;
                        var i = buf.indexOf("\n");
                        while (i>=0) {
                              onLine(buf.substr(0,i));
                              buf = buf.substr(i+1);
                              i = buf.indexOf("\n");
                            }
                        }); // connection.on ()
                        xconnect.textContent = "Disconnect Puck via Bluetooth";
            }); // End Puck.connect () 
}   
     

      xconnect.addEventListener("click", function () { bluetooth_connect() } );
  
  
</script>
</body>
</html>
